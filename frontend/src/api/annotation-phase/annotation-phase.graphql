# campaignPk is used to invalidate getCampaign tags
# noinspection GraphQLSchemaValidation
mutation endPhase($id: ID!, $campaignID: ID!) {
    endAnnotationPhase(id: $id) {
        ok
    }
}

mutation createAnnotationPhase(
    $campaignID: ID!
    $labelsWithAcousticFeatures: [ID]!
    $labelSetID: ID!
    $confidenceSetID: ID
    $allowPointAnnotation: Boolean!
) {
    createAnnotationPhase(campaignId: $campaignID, type: Annotation) {
        id
    }
    updateAnnotationCampaign(input: {
        id: $campaignID
        allowPointAnnotation: $allowPointAnnotation
        labelsWithAcousticFeatures: $labelsWithAcousticFeatures
        labelSet: $labelSetID
        confidenceSet: $confidenceSetID
    }) {
        errors {
            field
            messages
        }
    }
}

mutation createVerificationPhase($campaignID: ID!) {
    createAnnotationPhase(campaignId: $campaignID, type: Verification) {
        id
    }
}

query getAnnotationPhase(
    $campaignID: ID!
    $phase: AnnotationPhaseType!
    $userID: ID!
) {
    annotationPhaseByCampaignPhase(
        campaignId: $campaignID
        phaseType: $phase
    ) {
        id
        phase
        canManage
        endedAt
        hasAnnotations

        fileRanges: annotationFileRanges {
            tasksCount
        }
        completedTasks: annotationSpectrograms(annotationTasks_Status: Finished) {
            totalCount
        }
        userFileRanges: annotationFileRanges(annotator: $userID) {
            tasksCount
        }
        userCompletedTasks: annotationSpectrograms(annotationTasks_Status: Finished, annotator: $userID) {
            totalCount
        }
    }
}
